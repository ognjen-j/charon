package ognjenj.charon.acct.util;

import org.junit.Assert;
import org.junit.Test;

public class PasswordTest {
	@Test
	public void testPapPasswordSingleBlock() {
		String password = "test";
		String sharedSecret = "testing123";
		byte[] requestAuthenticator = {0x34, (byte) 0xbb, (byte) 0xfe, (byte) 0x8d, 0x08, (byte) 0x91, (byte) 0xd9,
				(byte) 0x82, (byte) 0xcc, 0x21, (byte) 0xa9, (byte) 0xc7, 0x1e, (byte) 0xb5, 0x5c, (byte) 0xad};
		byte[] expectedValue = {0x62, 0x18, 0x34, (byte) 0xca, 0x23, 0x52, 0x65, 0x61, (byte) 0x83, (byte) 0x86, 0x51,
				(byte) 0x94, 0x5c, (byte) 0xa3, 0x36, 0x67};
		byte[] calculatedPap = PasswordUtil.calculatePapPassword(password, sharedSecret, requestAuthenticator);
		Assert.assertArrayEquals(expectedValue, calculatedPap);
	}

	@Test
	public void testPapPasswordMultipleBlocks() {
		String password = "1234567890987654321234567890987654321234567890";
		String sharedSecret = "testing123";
		byte[] requestAuthenticator = {(byte) 0x9b, (byte) 0x8c, (byte) 0xbf, (byte) 0xc5, 0x29, (byte) 0xe7, 0x5c,
				0x53, (byte) 0x86, 0x7d, 0x2e, (byte) 0xc3, (byte) 0xad, (byte) 0xaf, (byte) 0x97, (byte) 0x9f};
		byte[] expectedValue = {0x6e, 0x08, (byte) 0xd1, 0x5c, 0x67, 0x2e, 0x0c, (byte) 0x9b, (byte) 0x98, 0x5d, 0x7a,
				0x26, 0x20, (byte) 0xcb, (byte) 0xc9, 0x02, 0x3d, 0x2f, 0x08, 0x19, (byte) 0xaf, (byte) 0xf6, 0x51,
				0x13, (byte) 0xec, 0x49, (byte) 0xda, 0x1a, 0x58, 0x4b, (byte) 0xca, (byte) 0xef, 0x10, (byte) 0x96,
				(byte) 0x8b, (byte) 0xa4, (byte) 0xe9, (byte) 0x8e, 0x62, (byte) 0x9a, (byte) 0xd2, 0x3b, 0x2b, 0x04,
				(byte) 0x94, 0x2b, (byte) 0xbb, (byte) 0xf6};
		byte[] calculatedPap = PasswordUtil.calculatePapPassword(password, sharedSecret, requestAuthenticator);
		Assert.assertArrayEquals(expectedValue, calculatedPap);
	}
}
